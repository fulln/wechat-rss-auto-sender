# WeChat RSS 自动发送器 - 增强版功能说明

## 🎯 核心改进

### 1. 英文提示词系统
- ✅ 将所有AI提示词提取到独立文件 `src/prompts.py`
- ✅ 使用专业的英文提示词，返回中文内容
- ✅ 提供多种AI功能：单篇总结、分类、标签、评分、孔子评论等

### 2. 单篇文章专门总结
- ✅ 每篇文章都有独立的AI深度分析
- ✅ 内容更丰富：150-300字（可配置）
- ✅ 结构化内容：标题重点 + 核心分析 + 影响解读
- ✅ 使用emoji表情增强可读性

### 3. 质量评分筛选机制 ⭐
- ✅ **只有7分以上的文章才能发送**（可配置）
- ✅ AI智能评分（0-10分）+ 降级简单评分
- ✅ 评分缓存避免重复计算
- ✅ 按质量排序选择最佳文章
- ✅ 详细的质量统计报告

## 📊 配置参数

### 新增配置项 (.env)
```properties
# AI总结配置
SUMMARY_MIN_LENGTH=150    # 最小总结长度
SUMMARY_MAX_LENGTH=300    # 最大总结长度

# 质量控制配置
MIN_QUALITY_SCORE=7       # 最低质量分数要求(0-10)
```

## 🚀 使用方式

### 1. 测试质量筛选
```bash
python scripts/test_quality_filter.py
```

### 2. 测试增强AI功能
```bash
python scripts/test_enhanced_ai_features.py
```

### 3. 运行完整服务
```bash
python -m src.main
```

## 📈 质量评分标准

### AI评分标准 (通过DeepSeek API)
- **内容清晰度**：逻辑是否清晰
- **准确性**：信息是否准确
- **深度**：分析是否深入
- **结构**：逻辑结构是否完整
- **语言表达**：是否流畅易读
- **完整性**：内容是否完整

### 降级评分标准 (API失败时)
- **标题质量**：长度和表达
- **描述丰富度**：内容量和质量
- **关键词匹配**：是否包含重要关键词

## 🎭 AI角色系统

### 可用角色类型
- `content_strategist`: 内容策划师（用于单篇总结）
- `news_summarizer`: 新闻总结助手（用于批量总结）
- `content_analyst`: 内容分析师（用于评分、分类）
- `confucius`: 孔子（用于传统文化评论）

## 📊 统计数据示例

```
📈 质量统计:
   已评分文章: 27/27
   平均评分: 5.9/10
   高质量文章: 12篇 (≥7分)
   质量达标率: 44.4%
```

## 🔄 工作流程

1. **RSS获取** → 2. **质量评分** → 3. **筛选高质量文章** → 4. **AI专门总结** → 5. **发送微信**

### 质量控制流程
```
未发送文章 → AI评分 → 评分≥7分? → 是 → 选择最高分 → 发送
                    ↓
                    否 → 跳过文章
```

## 💡 使用建议

1. **调整质量标准**：根据RSS源质量调整 `MIN_QUALITY_SCORE`
2. **内容长度**：根据微信使用习惯调整 `SUMMARY_MIN_LENGTH` 和 `MAX_LENGTH`
3. **API配置**：确保DeepSeek API密钥正确配置
4. **监控质量**：定期查看质量统计报告，了解文章质量分布

## 🛠️ 技术细节

- **模型使用**：DeepSeek Chat (代替 GPT-3.5-turbo)
- **评分缓存**：避免重复AI调用，提高效率
- **降级处理**：API失败时使用规则化评分
- **内容存储**：评分和时间戳持久化到缓存文件

## 🎯 效果对比

### 旧版本
- 批量总结，内容简单
- 没有质量筛选
- 固定发送间隔

### 新版本  
- 单篇专门总结，内容丰富
- AI质量评分筛选，只发送高质量内容
- 智能选择最佳文章
- 详细统计和监控
